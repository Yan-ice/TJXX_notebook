# 核平滑方法（Kernel Smoothing Methods）

## 1. 定义
核平滑方法是一种用于平滑数据的非参数统计技术。它通过使用一个 **核函数（Kernel Function）** 来对数据进行加权平均，以估计目标函数的值，通常用于数据拟合和回归问题。核平滑方法能够灵活地捕捉数据中的局部模式，而无需假设目标函数的具体形式。

## 2. 核函数（Kernel Function）
核函数是对样本点施加权重的函数，决定了每个样本对估计值的贡献。常见的核函数包括：
- **高斯核（Gaussian Kernel）**：
  \[
  K(u) = \frac{1}{\sqrt{2\pi}} e^{-\frac{u^2}{2}}
  \]
- **盒核（Box Kernel）**：
  \[
  K(u) =
  \begin{cases} 
  1 & |u| \leq 1 \\
  0 & \text{otherwise}
  \end{cases}
  \]
- **三角核（Triangle Kernel）**：
  \[
  K(u) = 1 - |u| \quad \text{for} \quad |u| \leq 1
  \]

核函数的形状决定了离估计点越远的样本点影响越小。

## 3. 平滑参数（Bandwidth）
平滑参数（又称 **带宽，h**）决定了核函数的作用范围。较大的带宽会导致更多的样本点参与加权平均，生成更加平滑的估计；而较小的带宽则只考虑靠近估计点的样本，产生更灵活但可能不太平滑的估计。

### 带宽的影响：
- **较小的带宽**：模型对数据的局部变化更敏感，但可能导致过拟合（overfitting）。
- **较大的带宽**：平滑效果较强，减少方差，但可能导致欠拟合（underfitting）。

---

# 核密度估计（Kernel Density Estimation, KDE）

## 1. 定义
核密度估计是一种用于估计概率密度函数的非参数方法。通过对数据点应用核函数，核密度估计提供了连续的密度估计。

## 2. 公式
核密度估计的表达式为：
\[
\hat{f}(x) = \frac{1}{n h} \sum_{i=1}^{n} K\left( \frac{x - x_i}{h} \right)
\]
- \( n \) 是样本数量；
- \( h \) 是带宽；
- \( K \) 是核函数；
- \( x_i \) 是样本点。

---

# 局部回归（Local Regression, LOESS/LOWESS）

## 1. 定义
局部回归是一种基于局部多项式拟合的非参数回归方法。它在估计每个点的回归函数时，只使用靠近该点的样本，并且通过核函数对这些样本进行加权。这使得局部回归能够灵活捕捉数据的非线性趋势。

## 2. 工作原理
局部回归的基本步骤如下：
1. 对于每个待估计点 \( x_0 \)，从数据中选择一个局部区域（由带宽 \( h \) 控制）。
2. 对这些局部样本使用核函数进行加权，距离 \( x_0 \) 越远的样本权重越小。
3. 在局部区域内拟合一个低阶多项式（通常是一阶或二阶多项式）。
4. 使用该多项式的预测值作为点 \( x_0 \) 处的估计值。

## 3. 公式
在点 \( x_0 \) 附近拟合一阶多项式的局部回归模型可以写作：
\[
y_i \approx \beta_0 + \beta_1 (x_i - x_0)
\]
其中 \( y_i \) 是目标变量，\( x_i \) 是自变量。通过最小化加权平方误差来估计系数 \( \beta_0 \) 和 \( \beta_1 \)，权重由核函数决定。

### 权重公式：
\[
W(x_i) = K\left( \frac{x_i - x_0}{h} \right)
\]
核函数 \( K \) 和带宽 \( h \) 决定了局部区域内样本的权重分配。

## 4. 特点
- **灵活性**：局部回归可以很好地适应非线性数据，捕捉数据中的局部模式。
- **局部化**：每个估计点都基于其附近的样本进行拟合，具有高度的局部特性。
- **非参数性**：与全局回归模型不同，局部回归不假设目标函数的全局形式。

## 5. 局限性
- **计算量大**：由于每个估计点都需要在局部区域内进行拟合，局部回归的计算复杂度较高，尤其在大数据集上。
- **带宽选择敏感**：带宽的选择对模型的性能影响很大，选择过大或过小的带宽都会影响模型的效果。

---

# 总结
- **核平滑方法** 提供了一种灵活的方式来对数据进行平滑或估计分布，通过核函数和带宽参数来控制局部区域的样本权重。
- **局部回归（Local Regression）** 是一种利用核函数加权局部样本进行多项式拟合的非参数回归方法，能够很好地适应非线性数据。
- **核密度估计** 是一种估计概率密度函数的非参数方法，广泛用于探索数据的分布结构。
- 核方法依赖于核函数的选择和带宽参数的设置，在实际应用中需要进行调参以获得最佳效果。

